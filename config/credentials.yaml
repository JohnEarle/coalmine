# Cloud Credentials Configuration
# ================================
# 
# Define cloud credentials and their associated accounts for canary deployment.
# Environment variables can be used with the following syntax:
#   - ${VAR_NAME}           - Required, fails if not set
#   - ${VAR_NAME:-default}  - Optional with default value
#   - ${VAR_NAME:?error}    - Required with custom error message
#
# Conflict Resolution:
#   Database entries take precedence over YAML entries. If a credential
#   with the same name exists in the database, the YAML entry is skipped.
#   This allows YAML to define baseline credentials while CLI commands
#   can override or customize them.
#
# To sync credentials from this file:
#   coalmine credentials sync
#
# To preview what would be synced:
#   coalmine credentials sync --dry-run

credentials:
  # Demo AWS credential (for testing)
  demo-aws-cred:
    provider: AWS
    auth_type: STATIC
    secrets:
      access_key_id: ${AWS_ACCESS_KEY_ID:-AKIAIOSFODNN7EXAMPLE}
      secret_access_key: ${AWS_SECRET_ACCESS_KEY:-wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY}
      region: ${AWS_DEFAULT_REGION:-us-east-1}
    # Optional: discovery configuration for organization-scoped credentials
    # discovery_config:
    #   member_role_name: CoalmineCanaryRole
    accounts:
      - name: demo-aws
        account_id: ${AWS_ACCOUNT_ID:-000000000000}
  
  # Demo GCP credential (requires env var)
  dev-gcp-cred:
    provider: GCP
    auth_type: STATIC
    secrets:
      service_account_json: ${GCP_SERVICE_ACCOUNT_JSON:?GCP service account required}
    accounts:
      - name: dev-gcp
        account_id: ${GCP_PROJECT_ID:-my-project}

  # Example AWS Organization credential (commented - uncomment and set env vars to use)
  # aws-org-cred:
  #   provider: AWS
  #   auth_type: ASSUME_ROLE
  #   secrets:
  #     access_key_id: ${AWS_ORG_ACCESS_KEY_ID}
  #     secret_access_key: ${AWS_ORG_SECRET_ACCESS_KEY}
  #   discovery_config:
  #     member_role_name: CoalmineCanaryRole
  #   accounts:
  #     # Accounts can be defined explicitly or discovered automatically
  #     - name: prod-east
  #       account_id: "111111111111"
  #       role_override: CustomRole  # Optional role override
  #     - name: prod-west
  #       account_id: "222222222222"
